theme_set(mytheme)
##Labels
#vector of labels for strength of selection
A.labs<-c("Weak selection","Moderate selection","Strong selection")
#name the vector to match actual values in data frame
names(A.labs)<-c("50.0","12.5","1.0")
#vector of labels for sex traits
Sex.labs<-c("Cryptic choice trait","Sperm trait")
#name the vector to match actual values in data frame
names(Sex.labs)<-c("Female","Male")
#vector of labels for variation
Var.labs <- c("Small Var", "Medium Var", "Large Var")
#name the vector to match actual values in data frame
names(Var.labs) <- c("LV", "MV", "HV")
#vector of labels for tradeoff
T.labs <- c("NA", "No tradeoff", "Tradeoff")
#name the vector to match actual values in data frame
names(T.labs) <- c("-1", "false", "true")
#vector of labels for number of loci
L.labs <- c("2 Loci", "20 Loci")
#name the vector to match actual values in data frame
names(L.labs) <- c("2", "20")
#vector of labels for population size
P.labs <- c("N = 1000", "N = 10000")
#name the vector to match actual values in data frame
names(P.labs) <- c("1000", "10000")
#Make color palette
pal <- rev(plasma(8)[c(1, 3, 5, 7)])
# 3. Loading up/processing data -------------------------------------------
runs_rawS<-readRDS("Data/All_runs_shortened.rds")
#Mutate runs_raw S to make sure all factors in the proper order
runs_rawS <- runs_rawS %>%
mutate(
A = factor(A, levels = c("50.0","12.5","1.0"), exclude = NULL),
Var = factor(Var, levels = c("LV", "MV", "HV")),
PopSize = factor(PopSize, levels = c("1000", "10000")),
CVCount=SDCount/MeanCount,
CVMale=SDMale/MeanMale,
CVFemale=SDFemale/MeanFemale)
#Summarize Runs for phenotypic plots
#Takes a long time to run so optionally load up already processed file
#SumRuns <- runs_rawS %>%
#  group_by(Generation, Level, A, Tradeoff, Loci, Var, PopSize) %>%
#  summarise_all(funs(mean = mean,sd = sd), na.rm = T) %>%
#  mutate(
#    A = factor(A, levels = c("50.0","12.5","1.0")),
#    Var = factor(Var, levels = c("LV", "MV", "HV")),
#    PopSize = factor(PopSize, levels = c("1000", "10000"))
#  )
#saveRDS(SumRuns,"SumRunsAll.rds")
SumRuns<-readRDS("Data/SumRunsAll.rds")%>%
mutate(
A = factor(A, levels = c("50.0","12.5","1.0")),
Var = factor(Var, levels = c("LV", "MV", "HV")),
PopSize = factor(PopSize, levels = c("1000", "10000"))
)
#Stabilizing selection
runs_rawStab<-readRDS("Data/Compiled_Shortened_DataS_MiddleVar_L_20.rds")
#Mutate runs_raw S to make sure all factors in the proper order
runs_rawStab <- runs_rawStab %>%
mutate(
A = factor(A, levels = c("50.0","12.5","1.0"), exclude = NULL),
Var = factor(Var, levels = c("LV", "MV", "HV")),
PopSize = factor(PopSize, levels = c("1000", "10000")),
CVCount=SDCount/MeanCount,
CVMale=SDMale/MeanMale,
CVFemale=SDFemale/MeanFemale)
#Summarize Runs for phenotypic plots
SumRunsStab <- runs_rawStab %>%
group_by(Generation, Level, A, Tradeoff, Loci, Var, PopSize) %>%
summarise_all(funs(mean = mean,sd = sd), na.rm = T) %>%
mutate(
A = factor(A, levels = c("50.0","12.5","1.0")),
Var = factor(Var, levels = c("LV", "MV", "HV")),
PopSize = factor(PopSize, levels = c("1000", "10000"))
)
#filter for the default scenario (20 number of loci, large population size, medium variation, and not fair raffle, )
SumRunsF20 <- SumRuns %>%
filter(Loci == "20", PopSize == "10000", Var == "MV")
#filter last generation for inset plots
runs_rawS_LGF20 <- runs_rawS %>%
filter(Loci == "20",
PopSize == "10000",
Var == "MV",
Generation == 30000)
#Stabilizing
#filter for the default scenario (20 number of loci, large population size, medium variation, and not fair raffle, )
SumRunsF20Stab <- SumRunsStab %>%
filter(Loci == "20", PopSize == "10000", Var == "MV")
#filter last generation for inset plots
runs_rawS_LGF20Stab <- runs_rawStab %>%
filter(Loci == "20",
PopSize == "10000",
Var == "MV",
Generation == 30000)
#make data frame of predicted investment and sperm number
#numbers directly taking from "AdaptiveDynamics.jl"
PredAn<-data.frame(Level=c("0.25","0.5","0.75","1.0"),Tradeoff=c("false","false","false","false","true","true","true","true"),PredN=c(16.10988593067346,23.66053786200191,28.9673742726416,33.18317009243252),PredT=c(16.10988593067346,23.66053786200191,28.9673742726416,33.18317009243252,805.4942965336729,1183.0268931000955,1448.36871363208,1659.1585046216262),PredS=c(16.10988593067346,23.66053786200191,28.9673742726416,33.18317009243252))
#Reading in last_2000 generation summary for all runs
runs_rawSumLast<-readRDS("Data/All_sum_Last2000.rds")
#Reading in data from raw last 20000 data for main figures
LData<-readRDS("Data/Last2000_MiddleVar_L_20.rds")
#Reading in data for evolutionary lag across all sensitivity analyses
LagAll<-read_rds("Data/Lag_2000_all.rds")%>%
mutate(Var = factor(Var, levels = c("LV", "MV", "HV")),
Diff= (Lag0-MinDiff)/Lag0)
# 4. Figure 1. Traits mean and cv ------------------------------------------
###Male (sperm trait and number) and Female (cryptic choice trait) traits
runs_rawS_LGF20$CVCount<-runs_rawS_LGF20$SDCount/runs_rawS_LGF20$MeanCount
runs_rawS_LGF20L<-runs_rawS_LGF20%>%
ungroup()%>%
select(MeanMale,MeanFemale,MeanCount,CVMale,CVFemale,CVCount,Level,A,Tradeoff)%>%
rename(
Mean_Sperm = MeanMale,
`Mean_Cryptic Choice` = MeanFemale,
CV_Sperm = CVMale,
`CV_Cryptic Choice` = CVFemale,
Mean_Count=MeanCount,
CV_Count=CVCount
) %>%
pivot_longer(
!c(Level,A,Tradeoff),
names_to = c(".value", "Sex"),
names_sep = "_"
)%>%
mutate(Sex=factor(Sex,levels=c("Cryptic Choice","Sperm","Count")))
#vector of labels for strength of selection
A.labs2<-c("Weak preference","Moderate preference","Strong preference")
#name the vector to match actual values in data frame
names(A.labs2)<-c("50.0","12.5","1.0")
(TM<-ggplot(runs_rawS_LGF20L, aes(
x = Level,
y = Mean,
fill = Sex,
color = Sex,
shape=Sex
)) +
facet_nested(Tradeoff ~ A, labeller = labeller(Tradeoff = T.labs, A =                                                 A.labs2))+
ylab("Mean trait")+
xlab("Risk of sperm competition (q)")+
geom_point(alpha=0.3,show.legend = T,position=position_jitterdodge(dodge.width = 1),size=0.8)+
geom_boxplot(alpha = 0.6,show.legend = F,outlier.shape = NA,width=0.5,position = position_dodge(1)) +
scale_color_manual(name = "Trait", values = c("#F8766D","#5F9EA080","black")) +
scale_fill_manual(name = "Trait", values = c("#F8766D","#5F9EA080","black"))+
labs(shape="Trait")+guides(fill = guide_legend(override.aes = list(
size = 5, alpha = 1
)))+theme(legend.position = "top"))
(TCV<-ggplot(runs_rawS_LGF20L, aes(
x = Level,
y = CV,
fill = Sex,
color = Sex,
shape = Sex
)) +
facet_nested(Tradeoff ~ A, labeller = labeller(Tradeoff = T.labs, A =                                                 A.labs2))+
ylab("Trait coefficient of variation")+
xlab("Risk of sperm competition (q)")+
geom_point(alpha=0.3,show.legend = F,position=position_jitterdodge(dodge.width = 1),size=0.8)+
geom_boxplot(alpha = 0.6,show.legend = F,outlier.shape = NA,width=0.5,position = position_dodge(1)) +
scale_color_manual(name = "Trait", values = c("#F8766D","#5F9EA080","black")) +
scale_fill_manual(name = "Trait", values = c("#F8766D","#5F9EA080","black"))+
labs(shape="Trait"))
((TM/TCV) & theme(text=element_text(size=18))
) + plot_annotation(tag_levels = "A", tag_suffix = ")")
(TM<-ggplot(runs_rawS_LGF20L, aes(
x = Level,
y = Mean,
fill = Sex,
color = Sex,
shape=Sex
)) +
facet_nested(Tradeoff ~ A, labeller = labeller(Tradeoff = T.labs, A =                                                 A.labs2))+
ylab("Mean trait")+
xlab("Risk of sperm competition (q)")+
geom_point(alpha=0.3,show.legend = T,position=position_jitterdodge(dodge.width = 1),size=0.8)+
geom_boxplot(alpha = 0.6,show.legend = F,outlier.shape = NA,width=0.5,position = position_dodge(1)) +
scale_color_manual(name = "Trait", values = c("#F8766D","#5F9EA080","black")) +
scale_fill_manual(name = "Trait", values = c("#F8766D","#5F9EA080","black"))+
labs(shape="Trait")+guides(fill = guide_legend(override.aes = list(
size = 5, alpha = 1
)))+theme(legend.position = "top"))
ggsave(
"Figure1.pdf",
height = 183 * 1.5,
width = 183 * 2.5,
units = "mm"
)
((TM/TCV) & theme(text=element_text(size=18))
) + plot_annotation(tag_levels = "A", tag_suffix = ")")
(TM<-ggplot(runs_rawS_LGF20L, aes(
x = Sex,
y = Mean,
fill = Sex,
color = Sex,
shape=Sex
)) +
facet_nested(Tradeoff ~ A + Level, labeller = labeller(Tradeoff = T.labs, A =                                                 A.labs2))+
ylab("Mean trait")+
xlab("Risk of sperm competition (q)")+
geom_point(alpha=0.3,show.legend = T,position=position_jitterdodge(dodge.width = 1),size=0.8)+
geom_boxplot(alpha = 0.6,show.legend = F,outlier.shape = NA,width=0.5,position = position_dodge(1)) +
scale_color_manual(name = "Trait", values = c("#F8766D","#5F9EA080","black")) +
scale_fill_manual(name = "Trait", values = c("#F8766D","#5F9EA080","black"))+
labs(shape="Trait")+guides(fill = guide_legend(override.aes = list(
size = 5, alpha = 1
)))+theme(legend.position = "top"))
((TM/TCV) & theme(text=element_text(size=18))
) + plot_annotation(tag_levels = "A", tag_suffix = ")")
(TM<-ggplot(runs_rawS_LGF20L, aes(
x = Level,
y = Mean,
fill = Sex,
color = Sex,
shape=Sex
)) +
facet_nested(Tradeoff ~ A, labeller = labeller(Tradeoff = T.labs, A =                                                 A.labs2))+
ylab("Mean trait")+
xlab("Risk of sperm competition (q)")+
geom_point(alpha=0.3,show.legend = T,position=position_jitterdodge(dodge.width = 1),size=0.8)+
geom_boxplot(alpha = 0.6,show.legend = F,outlier.shape = NA,width=0.5,position = position_dodge(1)) +
scale_color_manual(name = "Trait", values = c("#F8766D","#5F9EA080","black")) +
scale_fill_manual(name = "Trait", values = c("#F8766D","#5F9EA080","black"))+
labs(shape="Trait")+guides(fill = guide_legend(override.aes = list(
size = 5, alpha = 1
)))+theme(legend.position = "top"))
(TCV<-ggplot(runs_rawS_LGF20L, aes(
x = Level,
y = CV,
fill = Sex,
color = Sex,
shape = Sex
)) +
facet_nested(Tradeoff ~ A, labeller = labeller(Tradeoff = T.labs, A =                                                 A.labs2))+
ylab("Trait coefficient of variation")+
xlab("Risk of sperm competition (q)")+
geom_point(alpha=0.3,show.legend = F,position=position_jitterdodge(dodge.width = 1),size=0.8)+
geom_boxplot(alpha = 0.6,show.legend = F,outlier.shape = NA,width=0.5,position = position_dodge(1)) +
scale_color_manual(name = "Trait", values = c("#F8766D","#5F9EA080","black")) +
scale_fill_manual(name = "Trait", values = c("#F8766D","#5F9EA080","black"))+
labs(shape="Trait"))
((TM/TCV) & theme(text=element_text(size=18))
) + plot_annotation(tag_levels = "A", tag_suffix = ")")
(TM<-ggplot(runs_rawS_LGF20L, aes(
x = Level,
y = Mean,
fill = Sex,
color = Sex,
shape=Sex
)) +
facet_nested(Tradeoff ~ A+level, labeller = labeller(Tradeoff = T.labs, A =                                                 A.labs2))+
ylab("Mean trait")+
xlab("Risk of sperm competition (q)")+
geom_point(alpha=0.3,show.legend = T,position=position_jitterdodge(dodge.width = 1),size=0.8)+
geom_boxplot(alpha = 0.6,show.legend = F,outlier.shape = NA,width=0.5,position = position_dodge(1)) +
scale_color_manual(name = "Trait", values = c("#F8766D","#5F9EA080","black")) +
scale_fill_manual(name = "Trait", values = c("#F8766D","#5F9EA080","black"))+
labs(shape="Trait")+guides(fill = guide_legend(override.aes = list(
size = 5, alpha = 1
)))+theme(legend.position = "top"))
(TM<-ggplot(runs_rawS_LGF20L, aes(
x = Level,
y = Mean,
fill = Sex,
color = Sex,
shape=Sex
)) +
facet_nested(Tradeoff ~ A+Level, labeller = labeller(Tradeoff = T.labs, A =                                                 A.labs2))+
ylab("Mean trait")+
xlab("Risk of sperm competition (q)")+
geom_point(alpha=0.3,show.legend = T,position=position_jitterdodge(dodge.width = 1),size=0.8)+
geom_boxplot(alpha = 0.6,show.legend = F,outlier.shape = NA,width=0.5,position = position_dodge(1)) +
scale_color_manual(name = "Trait", values = c("#F8766D","#5F9EA080","black")) +
scale_fill_manual(name = "Trait", values = c("#F8766D","#5F9EA080","black"))+
labs(shape="Trait")+guides(fill = guide_legend(override.aes = list(
size = 5, alpha = 1
)))+theme(legend.position = "top"))
(TM<-ggplot(runs_rawS_LGF20L, aes(
x = Sex,
y = Mean,
fill = Sex,
color = Sex,
shape=Sex
)) +
facet_nested(Tradeoff ~ A+Level, labeller = labeller(Tradeoff = T.labs, A =                                                 A.labs2))+
ylab("Mean trait")+
xlab("Risk of sperm competition (q)")+
geom_point(alpha=0.3,show.legend = T,position=position_jitterdodge(dodge.width = 1),size=0.8)+
geom_boxplot(alpha = 0.6,show.legend = F,outlier.shape = NA,width=0.5,position = position_dodge(1)) +
scale_color_manual(name = "Trait", values = c("#F8766D","#5F9EA080","black")) +
scale_fill_manual(name = "Trait", values = c("#F8766D","#5F9EA080","black"))+
labs(shape="Trait")+guides(fill = guide_legend(override.aes = list(
size = 5, alpha = 1
)))+theme(legend.position = "top"))
?facet_nested
(TM<-ggplot(runs_rawS_LGF20L, aes(
x = Sex,
y = Mean,
fill = Sex,
color = Sex,
shape=Sex
)) +
facet_nested(Tradeoff ~ A+Level, labeller = labeller(Tradeoff = T.labs, A =                                                 A.labs2))+
ylab("Mean trait")+
xlab("Risk of sperm competition (q)")+
geom_point(alpha=0.3,show.legend = T,position=position_jitterdodge(dodge.width = 1),size=0.8)+
geom_boxplot(alpha = 0.6,show.legend = F,outlier.shape = NA,width=0.5,position = position_dodge(1)) +
scale_color_manual(name = "Trait", values = c("#F8766D","#5F9EA080","black")) +
scale_fill_manual(name = "Trait", values = c("#F8766D","#5F9EA080","black"))+
labs(shape="Trait")+guides(fill = guide_legend(override.aes = list(
size = 5, alpha = 1
)))+theme(legend.position = "top"))
TM+theme(axis.ticks.x = element_blank())
TM+theme(axis.ticks.x = element_blank(),axis.text.x = element_blank())
(TCV<-ggplot(runs_rawS_LGF20L, aes(
x = Level,
y = CV,
fill = Sex,
color = Sex,
shape = Sex
)) +
facet_nested(Tradeoff ~ A, labeller = labeller(Tradeoff = T.labs, A =                                                 A.labs2))+
ylab("Trait coefficient of variation")+
xlab("Risk of sperm competition (q)")+
geom_point(alpha=0.3,show.legend = F,position=position_jitterdodge(dodge.width = 1),size=0.8)+
geom_boxplot(alpha = 0.6,show.legend = F,outlier.shape = NA,width=0.5,position = position_dodge(1)) +
scale_color_manual(name = "Trait", values = c("#F8766D","#5F9EA080","black")) +
scale_fill_manual(name = "Trait", values = c("#F8766D","#5F9EA080","black"))+
labs(shape="Trait"))
TCV+scale_x_discrete(expand=c(0.2, 0))
TCV+scale_x_discrete(expand=c(1, 1))
TCV+scale_x_discrete(expand=c(1, 0))
TCV+scale_x_discrete(expand=c(0, 0))
TCV
(TM<-ggplot(runs_rawS_LGF20L, aes(
x = Sex,
y = Mean,
fill = Sex,
color = Sex,
shape=Sex
)) +
facet_nested(Tradeoff ~ A+Level, labeller = labeller(Tradeoff = T.labs, A =                                                 A.labs2))+
ylab("Mean trait")+
xlab("Risk of sperm competition (q)")+
geom_point(alpha=0.3,show.legend = T,position=position_jitterdodge(dodge.width = 1),size=0.8)+
geom_boxplot(alpha = 0.6,show.legend = F,outlier.shape = NA,width=0.5,position = position_dodge(1)) +
scale_color_manual(name = "Trait", values = c("#F8766D","#5F9EA080","black")) +
scale_fill_manual(name = "Trait", values = c("#F8766D","#5F9EA080","black"))+
labs(shape="Trait")+guides(fill = guide_legend(override.aes = list(
size = 5, alpha = 1
)))+theme(legend.position = "top"))
TM+theme(axis.ticks.x = element_blank(),axis.text.x = element_blank(),ggh4.x.)
TM+theme(axis.ticks.x = element_blank(),axis.text.x = element_blank(),ggh4.x.)
TM+theme(axis.ticks.x = element_blank(),axis.text.x = element_blank())
(TM<-ggplot(runs_rawS_LGF20L, aes(
x = Sex,
y = Mean,
fill = Sex,
color = Sex,
shape=Sex
)) +
facet_nested(Tradeoff ~ A+Level, labeller = labeller(Tradeoff = T.labs, A =                                                 A.labs2),strip.position = "bottom")+
ylab("Mean trait")+
xlab("Risk of sperm competition (q)")+
geom_point(alpha=0.3,show.legend = T,position=position_jitterdodge(dodge.width = 1),size=0.8)+
geom_boxplot(alpha = 0.6,show.legend = F,outlier.shape = NA,width=0.5,position = position_dodge(1)) +
scale_color_manual(name = "Trait", values = c("#F8766D","#5F9EA080","black")) +
scale_fill_manual(name = "Trait", values = c("#F8766D","#5F9EA080","black"))+
labs(shape="Trait")+guides(fill = guide_legend(override.aes = list(
size = 5, alpha = 1
)))+theme(legend.position = "top"))
(TM<-ggplot(runs_rawS_LGF20L, aes(
x = Sex,
y = Mean,
fill = Sex,
color = Sex,
shape=Sex
)) +
facet_nested(Tradeoff ~ A+Level, labeller = labeller(Tradeoff = T.labs, A =                                                 A.labs2),strip.position = "bottom")+
ylab("Mean trait")+
xlab("Risk of sperm competition (q)")+
geom_point(alpha=0.3,show.legend = T,position=position_jitterdodge(dodge.width = 1),size=0.8)+
geom_boxplot(alpha = 0.6,show.legend = F,outlier.shape = NA,width=0.5,position = position_dodge(1)) +
scale_color_manual(name = "Trait", values = c("#F8766D","#5F9EA080","black")) +
scale_fill_manual(name = "Trait", values = c("#F8766D","#5F9EA080","black"))+
labs(shape="Trait")+guides(fill = guide_legend(override.aes = list(
size = 5, alpha = 1
)))+theme(legend.position = "top"))
(TM<-ggplot(runs_rawS_LGF20L, aes(
x = Sex,
y = Mean,
fill = Sex,
color = Sex,
shape=Sex
)) +
facet_nested(Tradeoff ~ A+Level, labeller = labeller(Tradeoff = T.labs, A =                                                 A.labs2),switch = "x")+
ylab("Mean trait")+
xlab("Risk of sperm competition (q)")+
geom_point(alpha=0.3,show.legend = T,position=position_jitterdodge(dodge.width = 1),size=0.8)+
geom_boxplot(alpha = 0.6,show.legend = F,outlier.shape = NA,width=0.5,position = position_dodge(1)) +
scale_color_manual(name = "Trait", values = c("#F8766D","#5F9EA080","black")) +
scale_fill_manual(name = "Trait", values = c("#F8766D","#5F9EA080","black"))+
labs(shape="Trait")+guides(fill = guide_legend(override.aes = list(
size = 5, alpha = 1
)))+theme(legend.position = "top"))
(TM<-ggplot(runs_rawS_LGF20L, aes(
x = Sex,
y = Mean,
fill = Sex,
color = Sex,
shape=Sex
)) +
facet_nested(Tradeoff ~ A+Level, labeller = labeller(Tradeoff = T.labs, A =                                                 A.labs2),strip=strip_nested(switch = "x"))+
ylab("Mean trait")+
xlab("Risk of sperm competition (q)")+
geom_point(alpha=0.3,show.legend = T,position=position_jitterdodge(dodge.width = 1),size=0.8)+
geom_boxplot(alpha = 0.6,show.legend = F,outlier.shape = NA,width=0.5,position = position_dodge(1)) +
scale_color_manual(name = "Trait", values = c("#F8766D","#5F9EA080","black")) +
scale_fill_manual(name = "Trait", values = c("#F8766D","#5F9EA080","black"))+
labs(shape="Trait")+guides(fill = guide_legend(override.aes = list(
size = 5, alpha = 1
)))+theme(legend.position = "top"))
TM+theme(axis.ticks.x = element_blank(),axis.text.x = element_blank())
(TM<-ggplot(runs_rawS_LGF20L, aes(
x = Sex,
y = Mean,
fill = Sex,
color = Sex,
shape=Sex
)) +
facet_nested(Tradeoff ~ A+Level, labeller = labeller(Tradeoff = T.labs, A =                                                 A.labs2))+
ylab("Mean trait")+
xlab("Risk of sperm competition (q)")+
geom_point(alpha=0.3,show.legend = T,position=position_jitterdodge(dodge.width = 1),size=0.8)+
geom_boxplot(alpha = 0.6,show.legend = F,outlier.shape = NA,width=0.5,position = position_dodge(1)) +
scale_color_manual(name = "Trait", values = c("#F8766D","#5F9EA080","black")) +
scale_fill_manual(name = "Trait", values = c("#F8766D","#5F9EA080","black"))+
labs(shape="Trait")+guides(fill = guide_legend(override.aes = list(
size = 5, alpha = 1
)))+theme(legend.position = "top"))
TM+theme(axis.ticks.x = element_blank(),axis.text.x = element_blank())
(TM<-ggplot(runs_rawS_LGF20L, aes(
x = Sex,
y = Mean,
fill = Sex,
color = Sex,
shape=Sex
)) +
facet_nested(Tradeoff ~ A+Level, labeller = labeller(Tradeoff = T.labs, A =                                                 A.labs2))+
ylab("Mean trait")+
xlab("Risk of sperm competition (q)")+
geom_point(alpha=0.3,show.legend = T,position=position_jitterdodge(dodge.width = 1),size=0.8)+
geom_boxplot(alpha = 0.6,show.legend = F,outlier.shape = NA,width=0.5,position = position_dodge(1)) +
scale_color_manual(name = "Trait", values = c("#F8766D","#5F9EA080","black")) +
scale_fill_manual(name = "Trait", values = c("#F8766D","#5F9EA080","black"))+
labs(shape="Trait")+guides(fill = guide_legend(override.aes = list(
size = 5, alpha = 1
)))+theme(legend.position = "top"))
(TCV<-ggplot(runs_rawS_LGF20L, aes(
x = Sex,
y = CV,
fill = Sex,
color = Sex,
shape = Sex
)) +
facet_nested(Tradeoff ~ A + Level, labeller = labeller(Tradeoff = T.labs, A =                                                 A.labs2))+
ylab("Trait coefficient of variation")+
xlab("Risk of sperm competition (q)")+
geom_point(alpha=0.3,show.legend = F,position=position_jitterdodge(dodge.width = 1),size=0.8)+
geom_boxplot(alpha = 0.6,show.legend = F,outlier.shape = NA,width=0.5,position = position_dodge(1)) +
scale_color_manual(name = "Trait", values = c("#F8766D","#5F9EA080","black")) +
scale_fill_manual(name = "Trait", values = c("#F8766D","#5F9EA080","black"))+
labs(shape="Trait"))
((TM/TCV) & theme(text=element_text(size=18),axis.ticks.x = element_blank(),axis.text.x = element_blank())
) + plot_annotation(tag_levels = "A", tag_suffix = ")")
ggsave(
"Figure1.pdf",
height = 183 * 1.5,
width = 183 * 2,
units = "mm"
)
((TM/TCV) & theme(text=element_text(size=18),axis.ticks.x = element_blank(),axis.text.x = element_blank(),panel.spacing = unit(0, "mm"))
) + plot_annotation(tag_levels = "A", tag_suffix = ")")
((TM/TCV) & theme(text=element_text(size=18),axis.ticks.x = element_blank(),axis.text.x = element_blank(),panel.border = element_blank()))
((TM/TCV) & theme(text=element_text(size=18),axis.ticks.x = element_blank(),axis.text.x = element_blank(),strip.background = element_rect(size = 0.5))
) + plot_annotation(tag_levels = "A", tag_suffix = ")")
((TM/TCV) & theme(text=element_text(size=18),axis.ticks.x = element_blank(),axis.text.x = element_blank()))
((TM/TCV) & theme(text=element_text(size=18),axis.ticks.x = element_blank(),axis.text.x = element_blank())) + plot_annotation(tag_levels = "A", tag_suffix = ")")
ggsave(
"Figure1.pdf",
height = 183 * 1.5,
width = 183 * 2,
units = "mm"
)
((TM/TCV) & theme(text=element_text(size=18),axis.ticks.x = element_blank(),axis.text.x = element_blank(),panel.border = element_blank())) + plot_annotation(tag_levels = "A", tag_suffix = ")")
((TM/TCV) & theme(text=element_text(size=18),axis.ticks.x = element_blank(),axis.text.x = element_blank(), strip.background = element_rect(color=NA))) + plot_annotation(tag_levels = "A", tag_suffix = ")")
((TM/TCV) & theme(text=element_text(size=18),axis.ticks.x = element_blank(),axis.text.x = element_blank(), panel.border = element_blank())) + plot_annotation(tag_levels = "A", tag_suffix = ")")
ggsave(
"Figure1.pdf",
height = 183 * 1.5,
width = 183 * 2,
units = "mm"
)
((TM/TCV) & theme(text=element_text(size=18),axis.ticks.x = element_blank(),axis.text.x = element_blank())) + plot_annotation(tag_levels = "A", tag_suffix = ")")
((TM/TCV) & theme(text=element_text(size=18),axis.ticks.x = element_blank(),axis.text.x = element_blank()),panel.spacing = unit(0, "mm")) + plot_annotation(tag_levels = "A", tag_suffix = ")")
((TM/TCV) & theme(text=element_text(size=18),axis.ticks.x = element_blank(),axis.text.x = element_blank(),panel.spacing = unit(0, "mm"))) + plot_annotation(tag_levels = "A", tag_suffix = ")")
((TM/TCV) & theme(text=element_text(size=18),axis.ticks.x = element_blank(),axis.text.x = element_blank())) + plot_annotation(tag_levels = "A", tag_suffix = ")")
ggsave(
"Figure1.pdf",
height = 183 * 1.5,
width = 183 * 2,
units = "mm"
)
